---
title: "Cultural Spaces Report"
author: "Janssen Myer Rambaud"
output:
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE)
```

#### Preamble ####
#### Note: Preamble template was provided by owner Rohan Alexander in
####       Telling Stories with Data - 3, all credit goes to owner.

# Purpose: downloads the dataset using opendatatoronto
# Author: Janssen Myer Rambaud
# Date: January 15th, 2024
# Pre-requisites: 
# - Download dataset in 00-download_data.R and clean it in 01-data_cleaning.R

#### Workspace setup ####
Load packages
```{r}
library(tidyverse)
library(opendatatoronto)
library(janitor)
library(tidyr)
library(knitr)
```

Read and display a preview of the cleaned dataset from 01-data_cleaning.R
```{r}
cultural_spaces <- 
  read_csv('output/data/cultural_spaces_clean.csv')

cultural_spaces[] <-  lapply(cultural_spaces, tolower)

head(cultural_spaces)
```

For the graphs, it would be best to show whether or not there is a difference
in the 'type' of cultural space (performance, visual arts exhibition, screen-based, library, multipurpose, heritage) based on whether the space is city-owned or by the people.

```{r}
#| echo: false

category <- 
  c('performance', 
    'exhibition_visual_arts', 
    'screen_based', 
    'library', 
    'multipurpose', 
    'heritage')

# since splitting into grouped bars, its best to use gather to combine to keep count
grouped_data <- 
  gather(cultural_spaces, key = "category", value = "count", -ownership)

# handle the category elements
grouped_data$category <- 
  factor(grouped_data$category, levels = category)

# handle the count elements, need this for the summarize since not everything is numeric
grouped_data$count <- 
  as.numeric(grouped_data$count)


# summarize and count individual values before putting into plot
df <- 
  grouped_data |>
  group_by(category, ownership) |>
  summarize(total = sum(count, na.rm = TRUE)) # remove 'NA' values

ggplot(df, 
       aes(x = category, 
           y = total, 
           fill = ownership)) +
  geom_col(position='dodge') +  # dodge is for grouped plot
  labs(x = 'Category', y = 'Count') +
  ggtitle('Cultural Space in Relation to Ownership') +
  theme(axis.text.x=element_text(angle=60, hjust=1))
  
```

As you can see, a majority of the cultural space is owned by others, followed by city owned, then by city operated. It is also evident that performance and multipurpose cultural spaces are the most frequent cultural space type of the bunch. An interesting analysis is that library is completely owned and operated by the city, not a single branch is owned by others. 

